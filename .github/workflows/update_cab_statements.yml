name: fetch and update cabinent statements

on:
  schedule:
    - cron: '0 14 * * */5' # Every Friday at 2pm
  workflow_dispatch:

jobs:
    fetch_and_update_statements:
        name: fetch and update cabinent statements
        runs-on: ubuntu-latest
        steps:
            -   name:   Checkout to develop/master branch
                uses:   actions/checkout@v2 

            -   name:   Set up Python
                uses:   actions/setup-python@v4
                with:
                    python-version: '3.8' 
                
            -   name:   Install Python requirements
                run: |
                    python -m pip install --upgrade pip
                    pip install -r requirements.txt

            -   name:   Execute script
                run: |
                    cd src/gov_cab_statements_scrape
                    python3 main.py
                    cd ../..

            -   name:   Commit and push the changes into the repository (master branch) if there are any
                uses:   stefanzweifel/git-auto-commit-action@v4
                with:
                    commit_message: "Updated govza-cabinet-statements.json on `date` with GitHub Actions"